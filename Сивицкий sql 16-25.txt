Задание 16(2)
Найдите пары моделей PC, имеющих одинаковые скорость и RAM. В результате каждая пара указывается только один раз, т.е. (i,j), но не (j,i), Порядок вывода: модель с большим номером, модель с меньшим номером, скорость и RAM.

Решение:
SELECT DISTINCT A.MODEL AS MODEL_1, B.MODEL AS MODEL_2, A.SPEED, A.RAM
FROM PC AS A, PC B
WHERE (A.SPEED = B.SPEED AND A.RAM = B.RAM) AND A.MODEL > B.MODEL


Задание 17(2)
Найдите модели ПК-блокнотов, скорость которых меньше скорости каждого из ПК.
Вывести: type, model, speed

Решение:
SELECT DISTINCT PRODUCT.TYPE, LAPTOP.MODEL, LAPTOP.SPEED
FROM PRODUCT, LAPTOP
WHERE PRODUCT.MODEL = LAPTOP.MODEL 
AND 
SPEED < ALL (SELECT SPEED FROM PC)


Задание 18(2)
Найдите производителей самых дешевых цветных принтеров. Вывести: maker, price

Решение:
SELECT DISTINCT MAKER, PRICE
FROM PRODUCT JOIN PRINTER ON PRODUCT.MODEL = PRINTER.MODEL
and COLOR = 'y' and price = (select min(price) from printer WHERE COLOR = 'y')


Задание 19(1)
Для каждого производителя, имеющего модели в таблице Laptop, найдите средний размер экрана выпускаемых им ПК-блокнотов.
Вывести: maker, средний размер экрана.

Решение:
select maker, AVG(SCREEN) AS AVG_SCREEN
FROM PRODUCT JOIN LAPTOP ON PRODUCT.MODEL = LAPTOP.MODEL
GROUP BY MAKER


Задание 20(2)
Найдите производителей, выпускающих по меньшей мере три различных модели ПК. Вывести: Maker, число моделей ПК.

Решение:
SELECT DISTINCT MAKER, COUNT(MODEL) AS COUNT_MODEL
FROM PRODUCT
WHERE TYPE = 'PC'
GROUP BY MAKER
HAVING COUNT(MODEL) >= 3


Задание 21(1)
Найдите максимальную цену ПК, выпускаемых каждым производителем, у которого есть модели в таблице PC.
Вывести: maker, максимальная цена.

Решение:
SELECT MAKER, MAX(PC.PRICE) AS MAX_PRICE
FROM PRODUCT JOIN PC ON PRODUCT.MODEL = PC.MODEL
GROUP BY MAKER


Задание 22(1)
Для каждого значения скорости ПК, превышающего 600 МГц, определите среднюю цену ПК с такой же скоростью. Вывести: speed, средняя цена.

Решение:
SELECT SPEED, AVG(PRICE) AS AVG_PRICE
FROM PC
WHERE SPEED > '600'
GROUP BY SPEED


Задание 23(2)
Найдите производителей, которые производили бы как ПК
со скоростью не менее 750 МГц, так и ПК-блокноты со скоростью не менее 750 МГц.
Вывести: Maker

Решение:
SELECT MAKER
FROM PRODUCT JOIN PC ON PRODUCT.MODEL = PC.MODEL
WHERE PC.SPEED >= '750'
INTERSECT
SELECT MAKER
FROM PRODUCT JOIN LAPTOP ON PRODUCT.MODEL = LAPTOP.MODEL
WHERE LAPTOP.SPEED >= '750'


Задание 24(2)
Перечислите номера моделей любых типов, имеющих самую высокую цену по всей имеющейся в базе данных продукции.

Решение:
SELECT model
FROM (
 SELECT model, price
 FROM pc
 UNION
 SELECT model, price
 FROM Laptop
 UNION
 SELECT model, price
 FROM Printer
) as cte1
WHERE price = (
 SELECT MAX(price)
 FROM (
  SELECT price
  FROM pc
  UNION
  SELECT price
  FROM Laptop
  UNION
  SELECT price
  FROM Printer
  ) as cte2
 )
 
 
Задание 25(2)
Найдите производителей принтеров, которые производят ПК с наименьшим объемом RAM и с самым быстрым процессором среди всех ПК, имеющих наименьший объем RAM. Вывести: Maker
 
Решение:
SELECT DISTINCT MAKER
FROM PRODUCT JOIN PC ON PRODUCT.MODEL = PC.MODEL
WHERE MAKER IN (SELECT DISTINCT MAKER FROM PRODUCT WHERE TYPE = 'PRINTER')
AND SPEED = (SELECT MAX(SPEED) FROM PC WHERE RAM = (SELECT MIN(RAM) FROM PC))
AND RAM = (SELECT MIN(RAM) FROM PC)

